{% load static wagtailcore_tags wagtailuserbar %}

<!DOCTYPE html>
<html lang="fr" data-theme="light">
    <head>
        <meta charset="utf-8" />
        <title>
            {% block title %}
            {% if page.seo_title %}{{ page.seo_title }}{% else %}{{ page.title }}{% endif %}
            {% endblock %}
            {% block title_suffix %}
            {% wagtail_site as current_site %}
            {% if current_site and current_site.site_name %}- {{ current_site.site_name }}{% endif %}
            {% endblock %}
        </title>
        {% if page.search_description %}
        <meta name="description" content="{{ page.search_description }}" />
        {% endif %}
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        {% if page %}
        <link rel="canonical" href="{{ page.full_url }}" />
        {% endif %}

        {# Force all links in the live preview panel to be opened in a new tab #}
        {% if request.in_preview_panel %}
        <base target="_blank">
        {% endif %}
        <link rel="icon" href="{% static 'assets/ico.ico' %}"/>

        {# Google Fonts: Inter (Sans) & Playfair Display (Serif) #}
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">

        {# Global stylesheets #}
        <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-custom.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/project.css' %}">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

        {% block extra_css %}{% endblock %}

        <style>
            /* Custom utility overrides */
            :root {
                --bs-font-sans-serif: 'Inter', system-ui, -apple-system, sans-serif;
                --bs-font-serif: 'Playfair Display', serif;
            }
            body {
                font-family: var(--bs-font-sans-serif);
                color: #343a40;
            }
            h1, h2, h3, h4, h5, h6, .font-serif {
                font-family: var(--bs-font-serif);
            }
            
            /* Navbar */
            .navbar-brand img {
                transition: transform 0.3s ease;
            }
            .navbar-brand:hover img {
                transform: scale(1.05);
            }
            .nav-link {
                font-weight: 500;
                color: #495057;
                transition: color 0.2s ease;
            }
            .nav-link:hover, .nav-link.active {
                color: var(--bs-primary) !important;
            }
            .dropdown-menu {
                border: none;
                box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            }
            .dropdown-item {
                font-weight: 500;
                color: #495057;
            }
            .dropdown-item:active {
                background-color: var(--bs-primary);
            }

            /* Animations */
            .hover-lift {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .hover-lift:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
            }
            .hover-shadow {
                transition: box-shadow 0.3s ease;
            }
            .hover-shadow:hover {
                box-shadow: 0 1rem 3rem rgba(0,0,0,0.15) !important;
            }
            
            /* Utils */
            .backdrop-blur {
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            }
            
            /* Responsive Images */
            .rich-text-content img,
            article img,
            .content img {
                max-width: 100%;
                height: auto;
                display: block;
                margin: 1rem auto;
            }
            
            /* Footer */
            footer a:hover {
                color: var(--bs-primary) !important;
                text-decoration: underline !important;
            }
        </style>
    </head>

    <body class="d-flex flex-column min-vh-100 bg-light">
        {% wagtailuserbar %}

        <!-- Header / Navbar -->
        <header class="bg-white shadow-sm sticky-top z-3">
            <nav class="navbar navbar-expand-xl navbar-light py-2">
                <div class="container">
                    <!-- Logo & Brand -->
                    <a class="navbar-brand d-flex align-items-center gap-3 text-decoration-none me-4" href="/">
                        <img src="{% static 'assets/Blason_ville_fr_oise_ons_en_bray.svg' %}" 
                             alt="Blason Ons-en-Bray" 
                             style="width: 3.5rem; height: 3.5rem;"
                             class="d-inline-block align-text-top"
                        >
                        <div class="d-flex flex-column lh-1">
                            <span class="fs-4 fw-bold text-primary heading-font">
                                Ons-en-Bray
                            </span>
                            <span class="small text-uppercase tracking-wider text-muted fw-bold" style="letter-spacing: 1px; font-size: 0.65rem;">Mairie Officielle</span>
                        </div>
                    </a>

                    <!-- Mobile Toggler -->
                    <button class="navbar-toggler border-0 shadow-none p-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                        <div class="p-2">
                             <span class="navbar-toggler-icon"></span>
                        </div>
                    </button>

                    <!-- Navbar Links -->
                    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                        <div class="offcanvas-header border-bottom">
                            <h5 class="offcanvas-title fw-bold font-serif" id="offcanvasNavbarLabel">Menu</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                        </div>
                        <div class="offcanvas-body">
                            <ul class="navbar-nav justify-content-center flex-grow-1 gap-1">
                                <!-- MAIRIE -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        Mairie
                                    </a>
                                    <ul class="dropdown-menu border-0 shadow-lg rounded-3 mt-2">
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'la-mairie' %}">La Mairie</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'comptes-rendus-des-conseils-municipaux' %}">Comptes rendus conseils municipaux</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'arretes-municipaux-et-prefectoraux' %}">Arrêtés municipaux et préfectoraux</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'citoyennete-et-demarches' %}">Citoyenneté / démarches</a></li>
                                    </ul>
                                </li>
                                <!-- LE VILLAGE -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        Village
                                    </a>
                                    <ul class="dropdown-menu border-0 shadow-lg rounded-3 mt-2">
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'le-village' %}">Le village</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="https://www.ot-paysdebray.fr/fr/" target="_blank">À visiter</a></li>
                                    </ul>
                                </li>
                                <!-- ACTUALITÉS & ÉVÉNEMENTS -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        Actualités & Événements
                                    </a>
                                    <ul class="dropdown-menu border-0 shadow-lg rounded-3 mt-2">
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'actualites' %}">Actualités</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'evenements' %}">Événements</a></li>
                                    </ul>
                                </li>
                                <!-- VIE LOCALE -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        Vie Locale
                                    </a>
                                    <ul class="dropdown-menu border-0 shadow-lg rounded-3 mt-2">
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'ecole' %}">École</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'associations' %}">Associations</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="https://espacefamille.aiga.fr/index.html?dossier=11698905#connexion&152640" target="_blank">Accueil Loisirs</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'location-des-salles' %}">Location des salles</a></li>
                                    </ul>
                                </li>
                                <!-- SERVICES & INFOS -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        Services & Infos
                                    </a>
                                    <ul class="dropdown-menu border-0 shadow-lg rounded-3 mt-2">
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'medical' %}">Médical</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'artisans-commerçants-et-entreprises' %}">Artisans</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'collecte-des-dechets' %}">Collecte des déchets</a></li>
                                        <li><a class="dropdown-item py-2 px-3" href="{% slugurl 'numeros-utiles' %}">Numéros utiles</a></li>
                                    </ul>
                                </li>
                                <!-- CC -->
                                <li class="nav-item">
                                    <a class="nav-link" href="https://cc-paysdebray.com/" target="_blank">Communauté de Communes</a>
                                </li>
                            </ul>
                            
                            <!-- Actions -->
                            <div class="d-flex align-items-center gap-3 mt-3 mt-xl-0 ms-xl-4">
                                <!-- Search -->
                                <form class="d-flex position-relative" action="{% url 'search' %}" method="get">
                                    <div class="input-group input-group-sm">
                                        <input type="text" name="query" class="form-control rounded-pill ps-3 pe-5 border-secondary-subtle bg-light" placeholder="Rechercher..." aria-label="Rechercher">
                                        <button class="btn btn-link position-absolute end-0 top-50 translate-middle-y text-secondary pe-3 border-0 text-decoration-none" type="submit">
                                            <i class="bi bi-search"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="flex-grow-1">
            {% block content %}{% endblock %}
        </main>

        <!-- Footer -->
        <footer class="bg-white border-top border-3 border-primary pt-5 shadow-sm mt-auto">
            <div class="container pb-5">
                <div class="row g-5">
                    <!-- Brand -->
                    <div class="col-lg-4">
                        <a href="/" class="d-flex align-items-center gap-3 text-dark text-decoration-none mb-3">
                            <img src="{% static 'assets/Blason_ville_fr_oise_ons_en_bray.svg' %}" alt="Blason" style="width: 3.5rem;">
                            <div class="d-flex flex-column">
                                <span class="h4 fw-bold font-serif mb-0 text-primary">Ons-en-Bray</span>
                                <span class="small text-muted">Site officiel de la mairie</span>
                            </div>
                        </a>
                        <p class="text-secondary mb-4 small">
                            Commune située dans le département de l'Oise, en région Hauts-de-France.
                        </p>
                        <div class="d-flex gap-2">
                             <a href="https://fr.wikipedia.org/wiki/Ons-en-Bray" class="btn btn-primary btn-sm rounded-circle"><i class="bi bi-wikipedia"></i></a>
                             <a href="mailto:mairie@onsenbray.fr" class="btn btn-outline-primary btn-sm rounded-circle"><i class="bi bi-envelope-fill"></i></a>
                        </div>
                    </div>
                    
                    <!-- Quick Links -->
                    <div class="col-6 col-lg-2">
                        <h6 class="fw-bold mb-3 text-dark">Accès rapide</h6>
                        <ul class="list-unstyled d-flex flex-column gap-2 text-secondary small">
                            <li><a href="{% slugurl 'la-mairie' %}" class="text-decoration-none text-reset">La Mairie</a></li>
                            <li><a href="{% slugurl 'actualites' %}" class="text-decoration-none text-reset">Actualités</a></li>
                            <li><a href="{% slugurl 'evenements' %}" class="text-decoration-none text-reset">Agenda</a></li>
                            <li><a href="{% slugurl 'citoyennete-et-demarches' %}" class="text-decoration-none text-reset">Démarches</a></li>
                        </ul>
                    </div>

                    <!-- Contact -->
                    <div class="col-6 col-lg-3">
                        <h6 class="fw-bold mb-3 text-dark">Contact</h6>
                        <ul class="list-unstyled d-flex flex-column gap-3 text-secondary small">
                           <li class="d-flex gap-2">
                               <i class="bi bi-geo-alt-fill text-primary"></i>
                               <span>22 place de l'église<br>60650 Ons-en-Bray</span>
                           </li>
                           <li class="d-flex gap-2">
                               <i class="bi bi-telephone-fill text-primary"></i>
                               <span>03 44 81 61 07</span>
                           </li>
                           <li class="d-flex gap-2">
                               <i class="bi bi-envelope-at-fill text-primary"></i>
                               <span>mairie@onsenbray.fr</span>
                           </li>
                        </ul>
                    </div>

                    <!-- Horaires -->
                    <div class="col-lg-3">
                        <div class="bg-light p-3 rounded-3 border border-light shadow-sm">
                            <h6 class="fw-bold mb-3 text-dark d-flex align-items-center gap-2">
                                <i class="bi bi-clock text-primary"></i> Horaires
                            </h6>
                            <ul class="list-unstyled small text-secondary mb-0 d-flex flex-column gap-1">
                                <li class="d-flex justify-content-between"><span>Lun</span> <span>8:30-12 | 14-17</span></li>
                                <li class="d-flex justify-content-between"><span>Mar</span> <span>8:30-12 | 14-18</span></li>
                                <li class="d-flex justify-content-between text-muted"><span>Mer</span> <span>Fermé</span></li>
                                <li class="d-flex justify-content-between"><span>Jeu</span> <span>8:30-12 | 14-17:30</span></li>
                                <li class="d-flex justify-content-between"><span>Ven</span> <span>8:30-12 | 14-17:30</span></li>
                                <li class="d-flex justify-content-between"><span>Sam</span> <span>8:30-12:00</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom -->
            <div class="bg-primary text-white py-3">
                <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center small">
                    <div>&copy; {% now "Y" %} Mairie d'Ons-en-Bray.</div>
                    <div class="d-flex gap-3 mt-2 mt-md-0">
                        <a href="/mentions-legales/" class="text-white text-decoration-none opacity-75 hover-opacity-100">Mentions légales</a>
                        <span class="opacity-50">|</span>
                        <a href="https://pygab.dev/" target="_blank" class="text-white text-decoration-none opacity-75 hover-opacity-100">Développé par G. Trouvé</a>
                    </div>
                </div>
            </div>
        </footer>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

        {% block extra_js %}{% endblock %}
        <!-- Analytics -->
    <script async src="https://scripts.simpleanalyticscdn.com/latest.js"></script>

    </body>
</html>
